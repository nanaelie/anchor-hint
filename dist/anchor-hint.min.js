(function (global, factory) {
    typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :
    typeof define === 'function' && define.amd ? define(factory) :
    (global = typeof globalThis !== 'undefined' ? globalThis : global || self, global.AnchorHint = factory());
})(this, (function () { 'use strict';

    class AnchorHint {
        constructor({el, container, position, duration}) {
            if (!container || !el) return false;
            
            this.ctn = container;
            if (position) {
                this.top = position.top;
                this.left = position.left;
            } else {
                // this.rect_top = el.getBoundingClientRect().top;
                // this.rect_left = el.getBoundingClientRect().left;
                this.top = el.getBoundingClientRect().top - el.getBoundingClientRect().height - 8 + "px";
                this.left = (el.getBoundingClientRect().width / 2) + 8 + "px";
            }
            
            this.duration = duration ?? 200;
        }

        show(message) {
            this.construct(message);
            
            setTimeout(() => {
                this.ctn.removeChild(this.container);
            }, this.duration);
        }

        construct(message) {
            this.container = this._new('div', {
                width: 'auto',
                padding: '10px',
                color: '#fff',
                borderRadius: '10px',
                position: 'absolute',
                top: this.top,
                left: this.left,
                zIndex: '999999999',
                transition: `all ${this.duration} ease-in-out`,
                fontSize: '14px',
                borderBottomLeftRadius: '0',
                backgroundColor: '#28282855'
            });
            
            this._new('span', {
                width: '15px',
                height: '10px',
                borderBottomRightRadius: '10px',
                borderBottomLeftRadius: '10px',
                position: 'absolute',
                bottom: '-10px',
                left: '0',
                zIndex: '9999999999',
                backgroundColor: '#28282855'
            });

            const span = this._new('span', {
                fontStyle: 'italic'
            });

            span.textContent = message;

            this.container.appendChild(span);
            //this.container.appendChild(anchor);
            this.ctn.appendChild(this.container);
        }

        _new(el, style) {
            if (!el) return null;

            const htmlel = document.createElement(el);

            if (Object.entries(style)) {
                for (let kv of Object.entries(style)) {
                    var cssprop = kv[0];
                    var propval = kv[1];
                    htmlel.style[cssprop] = propval;
                }
            }

            return htmlel;
        }
    }

    return AnchorHint;

}));
